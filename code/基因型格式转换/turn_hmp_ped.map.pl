#!usr/bin/perl -w
use strict;

open(INPUT, "<$ARGV[0]")||die $!;
open(OUT,">$ARGV[0].ped")||die $!;
open(OUT1,">$ARGV[0].map") || die $!;
my (@diarray, @array,@arraytotal);

#提取表头信息
my $head = "rs	alleles	chrom	pos	strand	assembly	center	protLSID	assayLSID	panel	QCcode	Z1000	Z1001	Z1002	Z1003	Z1004	Z1005	Z1006	Z1007	Z1009	Z100	Z1010	Z1011	Z1012	Z1013	Z1014	Z1015	Z1016	Z1017	Z1018	Z1019	Z101	Z1020	Z1021	Z1022	Z1023	Z1024	Z1025	Z1026	Z1027	Z1028	Z1029	Z102	Z1030	Z1031	Z1032	Z1033	Z1034	Z1035	Z1036	Z1037	Z1038	Z1039	Z103	Z1040	Z1041	Z1042	Z1043	Z1044	Z1045	Z1046	Z1047	Z1048	Z1049	Z104	Z1050	Z1051	Z1052	Z1053	Z1054	Z1055	Z1056	Z1057	Z1058	Z1059	Z105	Z1060	Z1061	Z1062	Z1063	Z1064	Z1065	Z1066	Z1067	Z1068	Z1069	Z106	Z1070	Z1071	Z1072	Z1073	Z1074	Z1075	Z1076	Z1077	Z1078	Z1079	Z107	Z1080	Z1081	Z1082	Z1083	Z1084	Z1085	Z1086	Z1087	Z1088	Z108	Z1094	Z1095	Z1096	Z1097	Z1098	Z1099	Z109	Z10	Z1100	Z1101	Z1102	Z1103	Z1104	Z1105	Z1106	Z1107	Z1108	Z1109	Z110	Z1110	Z1111	Z1112	Z1113	Z1114	Z1115	Z1116	Z1117	Z1118	Z1119	Z111	Z1120	Z1121	Z1122	Z1123	Z1124	Z1125	Z1126	Z1127	Z1128	Z1129	Z112	Z1130	Z1132	Z1133	Z1137	Z1138	Z1139	Z113	Z1140	Z1141	Z1142	Z1143	Z1144	Z1145	Z1147	Z1148	Z1149	Z114	Z1150	Z1151	Z1152	Z1153	Z1154	Z1155	Z1156	Z1157	Z1159	Z115	Z1160	Z1161	Z1162	Z1163	Z1164	Z1165	Z1166	Z1167	Z1168	Z1169	Z116	Z1170	Z1171	Z1172	Z1173	Z1174	Z1175	Z1176	Z1177	Z1178	Z1179	Z117	Z1180	Z1181	Z1182	Z1183	Z1184	Z1185	Z1186	Z1187	Z1188	Z1189	Z118	Z1190	Z1191	Z1192	Z1193	Z1194	Z1195	Z1196	Z1197	Z1198	Z1199	Z119	Z11	Z1200	Z1201	Z1202	Z1203	Z1204	Z1205	Z1206	Z1207	Z1208	Z1209	Z120	Z1210	Z1211	Z1212	Z1213	Z1214	Z1215	Z1216	Z1217	Z1218	Z1219	Z121	Z1220	Z1221	Z1222	Z1223	Z1224	Z1225	Z1226	Z1227	Z1228	Z1229	Z122	Z1230	Z1231	Z1232	Z1233	Z1234	Z1235	Z1236	Z1237	Z1238	Z1239	Z123	Z1240	Z1241	Z1242	Z1243	Z1244	Z1245	Z1246	Z1248	Z1249	Z124	Z1250	Z1251	Z1252	Z1253	Z1254	Z1255	Z1256	Z1257	Z1258	Z125	Z1260	Z1261	Z1264	Z1266	Z1267	Z1268	Z1269	Z126	Z1270	Z1271	Z1272	Z1273	Z1274	Z1275	Z1276	Z1277	Z1278	Z1279	Z127	Z1280	Z1281	Z1282	Z1283	Z1284	Z1285	Z1286	Z1287	Z1288	Z1289	Z128	Z1290	Z1291	Z1292	Z1293	Z1294	Z1295	Z1296	Z1297	Z1298	Z1299	Z129	Z12	Z1300	Z1301	Z1303	Z1305	Z1306	Z1307	Z1308	Z130	Z1310	Z1311	Z1312	Z1313	Z1314	Z1315	Z1316	Z1317	Z1318	Z1319	Z131	Z1320	Z1321	Z1322	Z1323	Z1324	Z1325	Z1326	Z1327	Z1328	Z1329	Z132	Z1330	Z1331	Z1332	Z1333	Z1334	Z1335	Z1336	Z1337	Z1338	Z1339	Z133	Z1340	Z1341	Z1342	Z1343	Z1344	Z1345	Z1346	Z1347	Z1348	Z1349	Z134	Z1350	Z1352	Z1353	Z1354	Z1355	Z1356	Z1357	Z1358	Z1359	Z135	Z1360	Z1361	Z1362	Z1363	Z1364	Z1365	Z1366	Z1367	Z1368	Z1369	Z136	Z1370	Z1371	Z1372	Z1373	Z1374	Z1375	Z1376	Z1377	Z1378	Z1379	Z137	Z1380	Z1381	Z1382	Z1383	Z1384	Z1385	Z1386	Z1387	Z1388	Z1389	Z138	Z1390	Z1391	Z1392	Z1393	Z1394	Z1395	Z1396	Z1397	Z1398	Z1399	Z139	Z13	Z1400	Z1401	Z1402	Z1403	Z1404	Z1405	Z1406	Z1407	Z1408	Z1409	Z140	Z1410	Z1411	Z1413	Z1414	Z1415	Z1416	Z1417	Z1418	Z1419	Z141	Z1420	Z1421	Z1422	Z1423	Z1424	Z1425	Z1426	Z1427	Z1428	Z1429	Z142	Z1430	Z1431	Z1432	Z1433	Z1434	Z1435	Z1436	Z1437	Z1438	Z1439	Z143	Z1440	Z1441	Z1442	Z1443	Z1444	Z1445	Z1446	Z1447	Z1448	Z1449	Z144	Z1450	Z1451	Z1452	Z1453	Z1454	Z1455	Z1456	Z1457	Z1458	Z1459	Z145	Z1460	Z1461	Z1462	Z1463	Z1464	Z1465	Z1466	Z1467	Z1468	Z1469	Z146	Z1470	Z1471	Z1472	Z1473	Z1474	Z1475	Z1476	Z1477	Z1478	Z1479	Z147	Z1480	Z1481	Z1482	Z1483	Z1484	Z1485	Z1487	Z1488	Z1489	Z148	Z1490	Z1491	Z1492	Z1493	Z1494	Z1495	Z1496	Z1497	Z1498	Z1499	Z149	Z14	Z1500	Z1501	Z1502	Z1503	Z1504	Z150	Z151	Z152	Z153	Z154	Z155	Z156	Z157	Z158	Z159	Z15	Z160	Z161	Z162	Z163	Z164	Z165	Z166	Z167	Z168	Z169	Z16	Z170	Z171	Z172	Z173	Z174	Z175	Z176	Z177	Z178	Z179	Z17	Z180	Z181	Z182	Z183	Z184	Z185	Z186	Z187	Z188	Z189	Z18	Z190	Z191	Z192	Z193	Z194	Z195	Z196	Z197	Z198	Z199	Z19	Z1	Z200	Z201	Z202	Z203	Z204	Z205	Z206	Z207	Z208	Z209	Z20	Z210	Z211	Z212	Z213	Z214	Z215	Z216	Z217	Z218	Z219	Z21	Z220	Z221	Z222	Z223	Z224	Z225	Z226	Z227	Z228	Z229	Z22	Z230	Z231	Z232	Z233	Z234	Z235	Z236	Z237	Z238	Z239	Z23	Z240	Z241	Z242	Z243	Z244	Z246	Z247	Z248	Z249	Z24	Z250	Z251	Z252	Z253	Z254	Z255	Z256	Z257	Z258	Z259	Z25	Z260	Z261	Z262	Z263	Z264	Z265	Z266	Z267	Z268	Z269	Z26	Z270	Z271	Z272	Z273	Z274	Z275	Z276	Z277	Z278	Z279	Z27	Z280	Z281	Z282	Z283	Z284	Z285	Z286	Z287	Z288	Z289	Z28	Z290	Z291	Z292	Z293	Z294	Z295	Z296	Z297	Z298	Z299	Z29	Z2	Z300	Z301	Z302	Z303	Z304	Z305	Z306	Z307	Z308	Z309	Z30	Z310	Z311	Z312	Z313	Z314	Z315	Z316	Z317	Z318	Z319	Z31	Z320	Z321	Z322	Z323	Z324	Z325	Z326	Z327	Z328	Z329	Z32	Z330	Z331	Z332	Z333	Z334	Z335	Z336	Z337	Z338	Z339	Z33	Z340	Z341	Z342	Z343	Z344	Z345	Z346	Z347	Z348	Z349	Z34	Z350	Z351	Z352	Z353	Z354	Z355	Z356	Z357	Z358	Z359	Z35	Z360	Z361	Z362	Z363	Z364	Z365	Z366	Z367	Z368	Z369	Z36	Z370	Z371	Z372	Z373	Z374	Z375	Z376	Z377	Z378	Z379	Z37	Z380	Z381	Z382	Z383	Z384	Z385	Z386	Z387	Z388	Z389	Z38	Z390	Z391	Z392	Z393	Z394	Z396	Z398	Z399	Z39	Z3	Z400	Z401	Z402	Z403	Z404	Z405	Z406	Z407	Z408	Z409	Z40	Z410	Z411	Z412	Z413	Z414	Z415	Z416	Z417	Z418	Z419	Z41	Z420	Z421	Z422	Z423	Z424	Z425	Z426	Z427	Z428	Z429	Z42	Z430	Z431	Z432	Z433	Z434	Z435	Z436	Z437	Z438	Z439	Z43	Z440	Z441	Z442	Z443	Z444	Z445	Z446	Z447	Z448	Z449	Z44	Z450	Z451	Z452	Z453	Z454	Z455	Z456	Z457	Z458	Z459	Z45	Z460	Z461	Z462	Z463	Z464	Z465	Z466	Z467	Z468	Z469	Z46	Z470	Z471	Z472	Z473	Z474	Z475	Z476	Z477	Z478	Z479	Z47	Z480	Z481	Z482	Z483	Z484	Z485	Z486	Z487	Z488	Z489	Z48	Z490	Z491	Z492	Z493	Z494	Z495	Z496	Z497	Z498	Z499	Z49	Z4	Z500	Z501	Z502	Z503	Z504	Z505	Z506	Z507	Z508	Z509	Z50	Z510	Z511	Z512	Z513	Z514	Z515	Z516	Z517	Z518	Z519	Z51	Z520	Z521	Z522	Z523	Z524	Z525	Z526	Z527	Z528	Z529	Z52	Z530	Z531	Z532	Z533	Z535	Z537	Z538	Z539	Z53	Z540	Z541	Z542	Z543	Z544	Z545	Z548	Z549	Z54	Z551	Z552	Z553	Z554	Z555	Z556	Z557	Z558	Z559	Z55	Z560	Z561	Z562	Z563	Z564	Z565	Z566	Z567	Z568	Z569	Z56	Z570	Z571	Z572	Z573	Z574	Z575	Z576	Z577	Z578	Z579	Z57	Z580	Z581	Z582	Z583	Z584	Z585	Z586	Z587	Z588	Z589	Z58	Z590	Z591	Z592	Z593	Z594	Z595	Z596	Z597	Z598	Z599	Z59	Z5	Z600	Z601	Z602	Z603	Z604	Z605	Z606	Z607	Z608	Z609	Z60	Z610	Z611	Z612	Z613	Z614	Z615	Z616	Z617	Z618	Z619	Z61	Z620	Z621	Z622	Z623	Z624	Z625	Z626	Z627	Z628	Z629	Z62	Z630	Z631	Z632	Z633	Z634	Z635	Z636	Z637	Z638	Z639	Z63	Z640	Z641	Z642	Z643	Z644	Z645	Z646	Z647	Z648	Z649	Z64	Z650	Z651	Z652	Z653	Z654	Z655	Z656	Z657	Z658	Z659	Z65	Z660	Z661	Z662	Z663	Z664	Z665	Z666	Z667	Z668	Z669	Z66	Z670	Z671	Z675	Z676	Z677	Z678	Z679	Z67	Z680	Z681	Z682	Z683	Z685	Z686	Z687	Z688	Z689	Z68	Z690	Z691	Z698	Z699	Z69	Z6	Z700	Z701	Z702	Z704	Z705	Z706	Z70	Z71	Z721	Z722	Z725	Z726	Z727	Z728	Z729	Z72	Z730	Z731	Z732	Z733	Z734	Z735	Z736	Z737	Z738	Z739	Z73	Z740	Z741	Z742	Z743	Z744	Z745	Z746	Z747	Z748	Z749	Z74	Z750	Z751	Z753	Z754	Z755	Z756	Z757	Z758	Z759	Z75	Z760	Z761	Z762	Z763	Z764	Z765	Z766	Z767	Z768	Z769	Z76	Z770	Z771	Z772	Z773	Z774	Z775	Z776	Z777	Z778	Z779	Z77	Z780	Z781	Z782	Z783	Z784	Z785	Z786	Z787	Z788	Z789	Z78	Z790	Z791	Z792	Z793	Z794	Z795	Z796	Z797	Z798	Z799	Z79	Z7	Z800	Z802	Z803	Z804	Z805	Z806	Z807	Z808	Z809	Z80	Z810	Z811	Z812	Z813	Z814	Z815	Z816	Z817	Z818	Z819	Z81	Z820	Z821	Z822	Z823	Z824	Z825	Z826	Z827	Z828	Z829	Z82	Z830	Z831	Z832	Z833	Z834	Z835	Z836	Z837	Z838	Z839	Z83	Z840	Z841	Z842	Z843	Z844	Z845	Z846	Z847	Z848	Z849	Z84	Z850	Z851	Z852	Z853	Z854	Z855	Z856	Z857	Z858	Z859	Z85	Z860	Z861	Z862	Z863	Z864	Z865	Z866	Z867	Z868	Z869	Z86	Z870	Z871	Z872	Z873	Z874	Z875	Z876	Z877	Z878	Z879	Z87	Z880	Z881	Z882	Z883	Z884	Z885	Z886	Z887	Z889	Z88	Z890	Z891	Z892	Z893	Z894	Z895	Z896	Z897	Z898	Z899	Z89	Z8	Z900	Z901	Z902	Z903	Z904	Z905	Z906	Z907	Z908	Z909	Z90	Z910	Z911	Z912	Z913	Z914	Z915	Z916	Z917	Z918	Z919	Z91	Z920	Z921	Z923	Z924	Z925	Z926	Z927	Z928	Z929	Z92	Z930	Z931	Z932	Z933	Z934	Z935	Z936	Z937	Z938	Z939	Z93	Z940	Z941	Z942	Z943	Z944	Z945	Z946	Z947	Z948	Z949	Z94	Z950	Z951	Z952	Z953	Z954	Z955	Z956	Z957	Z958	Z959	Z95	Z960	Z961	Z962	Z963	Z964	Z965	Z966	Z967	Z968	Z969	Z96	Z970	Z971	Z972	Z973	Z974	Z975	Z976	Z977	Z978	Z979	Z97	Z980	Z981	Z982	Z983	Z984	Z985	Z986	Z987	Z988	Z989	Z98	Z990	Z991	Z993	Z994	Z995	Z997	Z999	Z99	Z9";
#chomp($head);
my @head = split(/\s+/,$head);
my @aa2= @head[11 .. $#head]; 
my (@aa1,@aa3,@aa4,@aa5,@aa6);


foreach(@aa2){
	my $id = "F$_";
	push(@aa1,"$id");
	push(@aa3,"0");push(@aa4,"0");push(@aa5,"0");push(@aa6,"0");
}

my %hash =(); my @order =();
for my $i(0 .. $#aa1){
	$order[$i] = $i;
	$hash{$i} = "$aa1[$i] $aa2[$i] $aa3[$i] $aa4[$i] $aa5[$i] $aa6[$i] ";
}

while(my $line= <INPUT>){
  chomp($line);   @array = ();
  my @tmp = split(/\s+/,$line);
  my $snp = $tmp[0];
  my $chr = $tmp[2];
  my $pos = $tmp[3]; 
  my @tmparray = @tmp[11 .. $#tmp];

  my %hashAA = ();
  foreach(0 .. $#tmparray){
	   if ($tmparray[$_] =~/[ATGC]{1}/) {
		   $hashAA{$tmparray[$_]}++;
		   $hashAA{$tmparray[$_]}++;
	   }elsif ($tmparray[$_] =~/[MRSKYW]{1}/) {
			if ($tmparray[$_] eq "M") {
				$hashAA{A}++; $hashAA{C}++;
			} elsif ($tmparray[$_]eq "R") {
				$hashAA{A}++; $hashAA{G}++;
			} elsif ($tmparray[$_] eq "W") {
				$hashAA{A}++; $hashAA{T}++;
			} elsif ($tmparray[$_]eq "S") {
				$hashAA{C}++; $hashAA{G}++;
			} elsif ($tmparray[$_]eq "Y") {
				$hashAA{C}++; $hashAA{T}++;
			} else {
				$hashAA{G}++; $hashAA{T}++;
			}
		}
  }
  my @keyss = keys %hashAA;
  #仅考虑二等位位点
  if($#keyss == 1){
	   foreach(0 .. $#tmparray){
		   my $base = "";
		   if ($tmparray[$_] =~/[ATGC]{1}/) {
			   $base = "$tmparray[$_] $tmparray[$_]"; 
		   }elsif ($tmparray[$_] =~/[MRSKYW]{1}/) {
				if ($tmparray[$_] eq "M") {
					$base ="A C"; 
				} elsif ($tmparray[$_]eq "R") {
					$base ="A G"; 
				} elsif ($tmparray[$_] eq "W") {
					$base ="A T"; 
				} elsif ($tmparray[$_]eq "S") {
					$base ="C G"; 
				} elsif ($tmparray[$_]eq "Y") {
					$base ="C T"; 
				} else {
					$base ="G T"; 
				}
			}else { 
				$base ="0 0"; 
			}
			 $hash{$_} .= "$base ";
		}
		print OUT1 "$chr\t$snp\t0\t$pos\n";
	}
}

foreach my $k(0 .. $#order){
		print OUT "$hash{$k}\n";		
}
close INPUT;
close OUT;
close OUT1;
exit;
